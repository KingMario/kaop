!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.kaop=n()}(this,function(){"use strict";function t(t){return!t.advice}function n(t,n,r){return function(){function i(){if(o++,r[o]){var t=r[o];e.isMethod(t)?(c.result=t.apply(c.scope,c.args),c.commit()):(t.call(void 0,c),e.isAsync(t)||c.commit())}}var o=-1,c={args:Array.prototype.slice.call(arguments),scope:this,key:n,method:e.getMethodFromArraySignature(r),target:t,result:void 0,commit:i,break:function(){this.commit=function(){}}};return i(),c.result}}function r(t,n,r){function e(){"function"==typeof this.constructor&&this.constructor.apply(this,arguments)}e.super=t,e.signature=n;var o=i.wove(e,n);return e.prototype=Object.assign(Object.create(t.prototype),o),e}var e={isMethod:t,isValidArraySignature:function(n){return n.every(function(t){return"function"==typeof t})&&1===n.filter(t).length},getMethodFromArraySignature:function(n){return n.find(t)},isAsync:function(t){return!!t.toString().match(/[a-zA-Z$_]\.commit/)},createInstance:function(t){return new t}},i={advice:function(t){return t.advice=1,t},aspect:function(t){return function(n){return Object.keys(n).reduce(t,n)}},wove:function(t,r){var i=Object.assign({},r);for(var o in i)i[o]instanceof Array&&e.isValidArraySignature(i[o])&&(i[o]=n(t,o,i[o]));return i},createProxyFn:n};return{createClass:function(t){return r(function(){},t)},extend:function(t,n){return r(t,n)},clear:function(t){for(var n in t.signature)t.signature[n]instanceof Array&&e.isValidArraySignature(t.signature[n])&&(t.prototype[n]=e.getMethodFromArraySignature(t.signature[n]));return t},override:{apply:i.advice(function(t){t.target.super.prototype[t.key].apply(t.scope,t.args)}),implement:i.advice(function(t){t.args.unshift(t.target.super.prototype[t.key].bind(t.scope))})},inject:{args:function(){var t=Array.prototype.slice.call(arguments);return i.advice(function(n){if("constructor"!==n.key)throw new Error("inject only available in constructor");n.args=t.map(function(t){return t()})})},assign:function(t){return i.advice(function(n){for(var r in t){var e=t[r];n.scope[r]=e()}})}},provider:{factory:function(t){return function(){return e.createInstance(t)}},singleton:function(t){var n;return function(){return n||(n=e.createInstance(t)),n}}},reflect:i}});
