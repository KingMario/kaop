!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.kaop={})}(this,function(e){"use strict";function t(e){return!e.advice}var r={isMethod:t,isValidArraySignature:function(e){return e.every(function(e){return"function"==typeof e})&&1===e.filter(t).length},getMethodFromArraySignature:function(e){return e.find(t)},isAsync:function(e){return!!e.toString().match(/[a-zA-Z$_]\.commit/)},createInstance:function(e,t){return t.unshift(null),new(Function.prototype.bind.apply(e,t))}};function n(e,t,n){return function(){var o=-1;function i(){if(n[++o]){var e=n[o];if(r.isMethod(e)){if(!c.prevented)try{if("constructor"===c.key&&"function"!=typeof c.target.super){var t=r.createInstance(c.target,c.args);Object.assign(t,c.scope),c.result=c.scope=t}else c.result=e.apply(c.scope,c.args)}catch(e){c.exception=e}}else e.call(void 0,c);r.isAsync(e)||c.commit()}else if(c.exception)throw c.exception}var c={args:Array.prototype.slice.call(arguments),scope:this,key:t,method:r.getMethodFromArraySignature(n),target:e,exception:void 0,prevented:void 0,result:void 0,commit:i,prevent:function(){c.prevented=!0},handle:function(){var e=c.exception;return delete c.exception,e},skip:function(){o=n.findIndex(r.isMethod)-1}};return i(),c.result}}var o={advice:function(e){return e.advice=1,e},aspect:function(e){return function(t){return Object.keys(t).reduce(e,t)}},wove:function(e,t){var o=Object.assign({},t);for(var i in o)o[i]instanceof Array&&r.isValidArraySignature(o[i])&&(o[i]=n(e,i,o[i]));return o},createProxyFn:n};function i(e,t,r){function n(){"function"==typeof this.constructor&&this.constructor.apply(this,arguments)}n.super=e,n.signature=t;var i=o.wove(n,t);return n.prototype=Object.assign(Object.create(e.prototype),i),n}var c=function(e){return i(function(){},e)},a=function(e,t){return i(e,t)},u=function(e){for(var t in e.signature)e.signature[t]instanceof Array&&r.isValidArraySignature(e.signature[t])&&(e.prototype[t]=r.getMethodFromArraySignature(e.signature[t]));return e},s={apply:o.advice(function(e){e.target.super.prototype[e.key].apply(e.scope,e.args)}),implement:o.advice(function(e){e.args.unshift(e.target.super.prototype[e.key].bind(e.scope))})},f={args:function(){var e=Array.prototype.slice.call(arguments);return o.advice(function(t){if("constructor"!==t.key)throw new Error("inject only available in constructor");e.forEach(function(e){t.args.push(e())})})},assign:function(e){return o.advice(function(t){for(var r in e){var n=e[r];t.scope[r]=n()}})}},p={factory:function(e){return function(){return r.createInstance(e,Array.prototype.slice.call(arguments))}},singleton:function(e){var t;return function(){var n=Array.prototype.slice.call(arguments);return t||(t=r.createInstance(e,n)),t}}},l=o,d={createClass:c,extend:a,clear:u,override:s,inject:f,provider:p,reflect:l};e.default=d,e.createClass=c,e.extend=a,e.clear=u,e.override=s,e.inject=f,e.provider=p,e.reflect=l,Object.defineProperty(e,"__esModule",{value:!0})});
